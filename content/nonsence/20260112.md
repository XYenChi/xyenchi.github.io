---
title: "Transformers RISC-V"
date: "2026-01-11T00:00:03+00:00"
draft: false
---
æ²¡æƒ³åˆ°ï¼Œè½¬æ¢æˆggufæ ¼å¼ï¼Œéœ€è¦å˜å½¢é‡‘åˆšã€‚   
ä½¿ç”¨ pytorch è¿è¡Œå¤§è¯­è¨€æ¨¡å‹ï¼Œéœ€è¦ç”¨åˆ° transformersï¼Œä½†æ˜¯ RISC-V æ²¡æœ‰ã€‚   
å…ˆç”¨ llama.cpp è¯•è¯•ã€‚

ä½¿ç”¨èŠ±é‡Œèƒ¡å“¨å‰ç«¯ç½‘ç«™ [hugging face](https://huggingface.co/)æ‹‰å–ä½ æœ€å–œçˆ±çš„å¤§é¢„è¨€æ¨¡å‹å§ï¼   
å®‰è£…å®Œ python-transformers, python-pytorch, å‘ç°pacmané‡Œæ²¡æœ‰ sentencepieceã€‚   
å¿«æ¥ä¸€èµ·ä½¿ç”¨æœ‰æ¯’çš„ python è™šæ‹Ÿç¯å¢ƒå§ï¼
```
python -m venv ~/.venv/sentencepiece
source ~/.venv/sentencepiece/bin/activate
pip install sentencepiece pytorch transformers
```
pytorch ä¸‹äº†ä¸€å †ï¼Œä»¤äººå®³æ€•ã€‚   
æˆåŠŸæ­å»ºèµ·å¯ä»¥ä½¿ç”¨ llama.cpp ä¸­çš„ `convert_hf_to_gguf.py` çš„ python è™šæ‹Ÿç¯å¢ƒå°†å¤§è¯­è¨€æ¨¡å‹è½¬æ¢æˆ .gguf æ ¼å¼ä¹‹åï¼ŒæŠŠ .gguf æ–‡ä»¶ä¼ åˆ° K1 ä¸Šï¼ŒæˆåŠŸè·‘èµ·æ¥äº†ä¸‰ç§’è¹¦å‡ºä¸€ä¸ªå­—çš„å¤§è¯­è¨€æ¨¡å‹ã€‚   
å½“ç„¶ï¼Œä»¥ K1 çš„æ€§èƒ½ä¸èƒ½æŒ‰ç…§é»˜è®¤é…ç½®è·‘ã€‚   
```
Loading model... \[1]    1812866 killed     ./build/bin/llama-cli --model ../deepseek-r1-distill-qwen-1.5b.gguf -p
```
éœ€è¦ä¿®æ”¹é…ç½®ï¼š
```
./build/bin/llama-cli \
  -m ../deepseek-r1-distill-qwen-1.5b.gguf \
  -p "ä½ å¥½" \
  -c 1024 \ // é™ä½ KV cache
  --no-mmap \ // é¿å…é¡µç¼“å­˜ + OOM
  --mlock \ // é˜²æ­¢è¢« swap
  -t 1 // å•çº¿ç¨‹
```
ä½†æ˜¯åªç”¨ llama.cpp è·‘æ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦ç”¨ pytorch ã€‚

åœ¨ K1 ä¸Šç”¨ python è™šæ‹Ÿç¯å¢ƒå¯ä»¥ä¸‹è½½ sentencepiece ä½†æ˜¯ä¸èƒ½ç”¨ transformersã€‚  
å†æ‰“ä¸ªåŒ…è¯•è¯•ã€‚ArchLinux çš„ gitlab ä¸è®©æˆ‘ https æ‹‰åŒ…äº† Orzï¼Œç”³è¯·è´¦å·ingã€‚   
ç„¶è€Œæç¬‘çš„æ˜¯ï¼Œhttps æ‹‰ä¸åˆ°åŒ…æ˜¯å› ä¸º ArchLinux å®˜æ–¹ä»“åº“é‡Œæœ¬æ¥å°±æ²¡æœ‰è¿™ä¸ªåŒ…ã€‚å› ä¸ºæˆ‘æ²¡æœ‰çœ‹æœåˆ°åŒ…çš„æ¥æºæ˜¯ archlinuxcnï¼Œä¸è¿‡å°±ç®—çœ‹äº†ä¹Ÿä¸æ˜¯çŸ¥é“å±äº AURã€‚   

### native
å°è¯•ä»æºç åœ¨ RISC-V ä¸Šæ„å»º transformersã€‚   
```
        Caused by: Failed to build a native library through cargo
        Caused by: Cargo build finished with "exit status: 101": `env -u CARGO PYO3_BUILD_EXTENSION_MODULE="1" PYO3_ENVIRONMENT_SIGNATURE="cpython-3.13-64bit" PYO3_PYTHON="/home/xyenchi/.venv/transformers/bin/python" PYTHON_SYS_EXECUTABLE="/home/xyenchi/.venv/transformers/bin/python" "cargo" "rustc" "--profile" "release" "--features" "pyo3/extension-module" "--message-format" "json-render-diagnostics" "--manifest-path" "/tmp/pip-install-pjykn0yj/tokenizers_88c57405900f4e5c8e26fca9b20a80ef/bindings/python/Cargo.toml" "--lib"`
      Error: command ['maturin', 'pep517', 'build-wheel', '-i', '/home/xyenchi/.venv/transformers/bin/python', '--compatibility', 'off'] returned non-zero exit status 1
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for tokenizers
  Building wheel for safetensors (pyproject.toml) ... error
  error: subprocess-exited-with-error

  Ã— Building wheel for safetensors (pyproject.toml) did not run successfully.
  â”‚ exit code: 1
  â•°â”€> [297 lines of output]
```
```
        Caused by: Failed to build a native library through cargo
        Caused by: Cargo build finished with "exit status: 101": `env -u CARGO PYO3_BUILD_EXTENSION_MODULE="1" PYO3_ENVIRONMENT_SIGNATURE="cpython-3.13-64bit" PYO3_PYTHON="/home/xyenchi/.venv/transformers/bin/python" PYTHON_SYS_EXECUTABLE="/home/xyenchi/.venv/transformers/bin/python" "cargo" "rustc" "--profile" "release" "--features" "pyo3/extension-module" "--message-format" "json-render-diagnostics" "--manifest-path" "/tmp/pip-install-pjykn0yj/safetensors_eeec8ab73bd1467fba4b87a6d7305d04/bindings/python/Cargo.toml" "--lib"`
      Error: command ['maturin', 'pep517', 'build-wheel', '-i', '/home/xyenchi/.venv/transformers/bin/python', '--compatibility', 'off'] returned non-zero exit status 1
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for safetensors
Successfully built transformers
Failed to build tokenizers safetensors
error: failed-wheel-build-for-install

Ã— Failed to build installable wheels for some pyproject.toml based projects
â•°â”€> tokenizers, safetensors
```
safetensor éœ€è¦ pythonç‰ˆæœ¬<=3.12
```
error: the configured Python interpreter version (3.13) is newer than PyO3's maximum supported version (3.12)
  = help: please check if an updated version of PyO3 is available. Current version: 0.21.1
  = help: set PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1 to suppress this check and build anyway using the stable ABI
warning: build failed, waiting for other jobs to finish...
ğŸ’¥ maturin failed
  Caused by: Failed to build a native library through cargo
  Caused by: Cargo build finished with "exit status: 101": `env -u CARGO PYO3_BUILD_EXTENSION_MODULE="1" PYO3_ENVIRONMENT_SIGNATURE="cpython-3.13-64bit" PYO3_PYTHON="/usr/bin/python" PYTHON_SYS_EXECUTABLE="/usr/bin/python" "cargo" "rustc" "--profile" "release" "--features" "pyo3/extension-module" "--message-format" "json-render-diagnostics" "--manifest-path" "/build/python-safetensors/src/safetensors-0.4.3/bindings/python/Cargo.toml" "--lib"`
Error: command ['maturin', 'pep517', 'build-wheel', '-i', '/usr/bin/python', '--compatibility', 'off'] returned non-zero exit status 1
```

ç»ˆäºç»™ safetensors å’Œ tokenizers éƒ½è®¾ç½®ç¯å¢ƒå˜é‡ `export PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1` å¹¶ç»™ tokenizers é…ç½®ç¯å¢ƒå˜é‡é™æ€é“¾æ¥ä¹‹åå¥½äº† Orzã€‚   ä½†ä¹Ÿå› æ­¤é”™å¤±äº†å…¥å‘ nix çš„æœºä¼šï¼Œæ²¡æœ‰åƒä¸Šå®‰åˆ©çœŸæ˜¯å¯æƒœã€‚   

çœŸäºæˆ‘æŠŠ python-regex python-huggingface_hub python_transformers python-safetensors python-tokenizers æ‰“äº†ä¸ªéã€‚

